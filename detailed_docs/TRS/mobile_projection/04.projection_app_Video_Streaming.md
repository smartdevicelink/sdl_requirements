## Functional requirements

1. 
In case  
app with HMIType = PROJECTION running in FULL HMILevel   
successfully opens RPC (7) service  
and sends StartService_request to open video service  

SDL must  
- respond+ StartService_ACK for video service over control service to mobile app  
- open  Video service for this app  
- send StartStream_request to HMI

2. 
In case
app with HMIType = PROJECTION   
requests to open video service via StartService_request  
and "serviceType" = 7 (RPC) is not yet acknowledged for this application

SDL must  
respond StartService_NACK for to this mobile app and  
NOT open Video service for this app

3.
In case  
SDL sends StartStream_request to HMI  
and HMI respond with any `<errorCode>` to StartStream_request  

SDL must  
send failed StartStream_request to HMI as many times as defined at "StartStreamRetry" param at .ini file 

4.  
In case  
SDL sends StartStream_ request to HMI  
and HMI does NOT respond to StartStream_request during <DefaultTimeout> (value form .ini file)  

SDL must  
send non-responded StartStream_request to HMI as many times as defined at "StartStreamRetry" param at .ini file  

5.
In case  
SDL sends StartStream_request to HMI during retry strategy  
and HMI responds StartStream (`<any_resultCode>`) to SDL during active retry strategy  

SDL must  
stop sending StartStream right after receiving response from HMI (stop retry strategy)  

6.  
In case  
SDL sends StartStream to HMI during retry strategy  
and HMI respond any `<errorCode>` to StartStream during retry strategy

SDL must  
send StopStream  to HMI  
send EndService for video service to mobile app  

7.  
In case  
SDL sends StartStream to HMI during retry strategy  
and HMI does not respond to StartStream during retry strategy  

SDL must  
send StopStream to HMI  
send EndService for video service to mobile app  

8.  
In case  
SDL sends StartStream to HMI during retry strategy  
and HMI respond with successfull `<resultCode>` to StartStream during retry strategy  

SDL must  
keep Video service opened for mobile app  

9.  
In case
app with HMIType = PROJECTION running in FULL HMILevel successfully opens video service  
and starts streaming (sends the raw data) over this opened video service  

SDL must  
send Navigation.OnVideoDataStreaming (available:true) to HMI  

10.  
In case  
app with HMIType = PROJECTION  
is streaming over successfully opened video service  
and stops streaming (stop sending the raw data) over this opened video service  
and does not restart sending video data during SDL's "VideoDataStoppedTimeout" timeout  

SDL must
send Navigation.OnVideoDataStreaming (available:false) to HMI  

11.  
In case  
app with HMIType = PROJECTION with `<appID_1>` is running in FULL HMILevel  
and has successfully opened video service  
and this app receives BACKGROUND or NONE HMILevel by any reason  

SDL must  
send EndService for  video  service to mobile app  
start "StopStreamingTimeout" timer (the value defined at .ini file)  
send  StopStream_request to HMI 

12.  
In case
app with HMIType = PROJECTION running in BACKGROUND or NONE HMILevel  
does NOT send EndService_ACK during the "StopStreamingTimeout" timer  

SDL must  
send OnAppInterfaceUnregistered (PROTOCOL_VIOLATION) to mobile app  
send OnAppUnregistered (unexpededDisconnect=false) to HMI

13.  
In case
app with HMIType = PROJECTION running in BACKGROUND or NONE HMILevel  
sends EndService_ACK during the "StopStreamingTimeout" timer   

SDL must  
keep this app still connected (SDL must NOT unregister this app)  
close video service for this app

## Diagram

Mobile projection data streaming

![Mobile projection data streaming](https://github.com/smartdevicelink/sdl_requirements/blob/master/detailed_docs/accessories/projection_app_data_streaming.png)

